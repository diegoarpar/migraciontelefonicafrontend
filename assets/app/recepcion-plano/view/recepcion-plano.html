
<div id="page-wrapper">
    <div data-toggle="collapse" data-target="#arbol" class="ui-content">Seleccione el Árbol</div>
    <div id="arbol" class="collapse">
    <div class="row">
        <div class="col-md-12">

            <div ui-tree class="col-md-3 well" id="tree-root">
                <ol ui-tree-nodes ng-model="trds">
                    <li ng-repeat="trd in trds" ui-tree-node collapsed="true">
                        <div data-nodrag ui-tree-handle ng-click="setPointer();toggle(this)">
                            <a data-nodrag>
                                <span class="glyphicon" ng-class="{'glyphicon-chevron-right': collapsed, 'glyphicon-chevron-down': !collapsed}">

                                </span></a>
                            <a>{{trd.name}}</a>
                        </div>
                        <ol ui-tree-nodes="" ng-model="trd.series" ng-class="{hidden: collapsed}">
                            <li ng-repeat="serie in trd.series" ui-tree-node collapsed="true">
                                <div data-nodrag ui-tree-handle ng-click="setPointer([trd.code,serie.code]);toggle(this)">
                                    <a data-nodrag><span class="glyphicon" ng-class="{'fa fa-folder': collapsed, 'fa fa-folder-open': !collapsed}">

                                    </span></a>
                                    <a>{{serie.name}}</a>
                                </div> <ol ui-tree-nodes="" ng-model="serie.subseries" ng-class="{hidden: collapsed}">
                                <li ng-repeat="subserie in serie.subseries" ui-tree-node collapsed="true">
                                    <div data-nodrag ui-tree-handle ng-click="setPointer([trd.code,serie.code,subserie.code]);toggle(this)">
                                        <a data-nodrag><span class="glyphicon" ng-class="{'fa fa-folder-o': collapsed, 'fa fa-folder-open-o': !collapsed}">

                                        </span>
                                        </a>
                                        <a>{{subserie.name}}</a>
                                    </div>
                                </li>
                            </ol>
                                <ol ui-tree-nodes="" ng-model="serie.documentTypes" ng-class="{hidden: collapsed}">
                                    <li ng-repeat="documentType in serie.documentTypes" ui-tree-node>
                                        <div data-nodrag ui-tree-handle>
                                            <a ng-click="loadDocumentTypeMetadata(documentType)">
                                                {{documentType.name}}
                                            </a>
                                        </div>
                                    </li>
                                </ol>
                            </li>
                        </ol>
                    </li>
                </ol>
            </div>
        </div>
        </div></div>


    <h4>Seleccionar criterios de búsqueda por metadatos</h4>
    <button type="button" class="btn btn-info marginated ng-binding ng-scope"
            ng-repeat="m in availableMetadata" ui-draggable="true" drag="m"
            on-drop-success="dropSuccessHandler($event,$index,availableMetadata)"
            draggable="true">
        {{m.name}}
    </button>


  <h2>ARCHIVO PLANO trd:{{query.trd}} series:{{query.series}} subseries:{{query.subSeries}}</h2>
  <div data-toggle="collapse" data-target="#desdeArchivo" class="ui-content">Desde archivo</div>
  <div id="desdeArchivo" class="collapse">
    <input type="file" class="btn green"  on-read-file="showContent($fileContent)" />

    </div>

    <div ng-if="digital.length>0">
        <h3>Cantidad de garantías: {{ digital.length }}</h3>

    </div>
    <div ng-show="false">
        <h3>Radicado: {{ numero[0].number }}</h3>

    </div>
    <div class="form-group">
    <div class="col-sm-12" >
        <div data-toggle="collapse" data-target="#demo" class="ui-content">Ver Columnas</div>
      <div id="demo" class="collapse">
      <div ng-repeat="c in all_columns" >
          ver:
          <input type="checkbox" ng-model="c.checked"/>
           {{c.title}}

          <select  ng-model="c.columnName" >
              <option ng-repeat="r in fields" value="{{r.key}}">{{r.value}}</option>
          </select>
          <span ng-if="c.columnName">
              -- buscar:
              <input type="checkbox" ng-model="c.buscar"/>
              datoaMigrar:
              <input type="checkbox" ng-model="c.datoaMigrar"/>
          </span>

      </div>
          <div>
              <select  ng-model="columnName" >
                  <option ng-repeat="r in fields" value="{{r.key}}">{{r.value}}</option>
              </select>
          <button class="btn green" ng-click="addColumn(columnName)">Agregar Columna</button>
          </div>
    </div>

      </div>
    </div>



    <table  ng-table="tablaGarantias" show-filter="true"   export-csv="csv" separator=";" class="table table-striped table-hover table-condensed " >
        <thead>
        <tr>
            <th> id </th>
            <th> encontrado</th>

          <th ng-repeat="c in columns">{{ c.title }}
          </th>
          <th> opciones </th>
        </tr>
        </thead>
        <tr ng-repeat="c in digital" ng-include="getTemplate(c)">
            <!--td data-title="'r0'"  sortable="'r0'" filter="{ 'r0': 'text'}">{{ c.r0 }}</td>
            <td data-title="'r0'"  sortable="'r1'" filter="{ 'r2': 'text'}">{{ c.r1 }}</td>
            <td data-title="'r0'"  sortable="'r2'" filter="{ 'r1': 'text'}">{{ c.r2 }}</td>
            <td><button class="btn btn-danger" ng-click="removeRow($index)">del</button></td>
            <td><button ng-click="editRow(c)">Edit</button></td-->

        </tr>
    </table>

     <script type="text/ng-template" id="display">
            <th>{{c.id}}</th>
            <td >{{c.encontrado}}</td>
          <td ng-repeat="e in columns">{{ c[e.title] }}</td>

            <button ng-click="editRow(c)" class="btn green">Modificar</button>
            <button ng-click="removeRow($index)" class="btn btn-danger">Quitar</button>
        </th>

    </script>
    <script type="text/ng-template" id="edit">
        <td>{{c.id}}</td>
        <td ><input type="checkbox" ng-model="c.encontrado"></td>
        <td ng-repeat="e in columns"><input type="text" ng-model="digital.selected[e.title]" /></td>
        <td>
            <button ng-click="saveRow($index)" class="btn green">Guardar</button>
            <button ng-click="reset()" class="btn btn-danger">Cancelar</button>
        </td>
    </script>

    <div>
      <button class="btn green" ng-click="addRow()">Agregar Registro</button>
      <button class="btn green" ng-click="searchPlanilla()">Consultar Plano</button>
      <button class="btn green" ng-click="migrar()">Confirmar Plano</button>
    </div>
</div>



